@page "/login"
@using Cineflex.Services.Authentication
@using Microsoft.AspNetCore.Identity.Data
@inject ISnackbar Snackbar
@inject NavigationManager NavigationManager
@rendermode InteractiveServer
<PageTitle>Login</PageTitle>



<div class="@($"color-transition {_backgroundClass}")"
     style="position: fixed; top: 0; left: 0; height: 100vh; width: 100vw; display: flex; justify-content: center; align-items: center;">

    <div class="row @(chairsVisible ? "row-visible" : "row-hidden")">
        @for (int i = 0; i < 25; i++)
        {
            <div class="chair">
                <div class="backrest"></div>
                <div class="seat"></div>
                <div class="arm left"></div>
                <div class="arm right"></div>
                <div class="leg left"></div>
                <div class="leg right"></div>
            </div>
        }
    </div>

    @if (!_isLoggedIn)
    {
        <!-- Main login card -->
        <MudCard Style="position: fixed; top: 20vh; left: 35vw; width: 450px; background-color:#272727; padding:15px; border-radius:15px" Elevation="25">
            <!-- Login form -->
            <MudForm @ref="_form">
                <MudCardContent>

                    <div style="display: flex; justify-content: center; align-items: center; padding: 20px;">
                        <img src="Picture/Logo_Cineflex.png" style="height: 100px; width: 125px;" alt="Cineflex Logo" />
                    </div>


                    <!-- Email input field -->
                    <MudTextField Label="Email"
                                  
                                  @bind-Value="_loginFormModel.Email"
                                  Class="textCollor white-placeholder "
                                  For="@(() => _loginFormModel.Email)"
                                  InputType="InputType.Email"
                                  Placeholder="naam@gmail.com"
                                  Variant="Variant.Filled" />

                    <!-- Password input field with visibility toggle -->
                    <MudTextField T="string"
                                  Label="Wachtwoord"
                                  @bind-Value="_loginFormModel.Password"
                                  For="@(() => _loginFormModel.Password)"
                                  Class="textCollor white-placeholder"
                                  InputType="@PasswordInputType"
                                  Placeholder="***************"
                                  Variant="Variant.Filled"
                                  Adornment="Adornment.End"
                                  AdornmentIcon="@PasswordInputIcon"
                                  AdornmentColor="Color.Inherit"
                                  OnAdornmentClick="TogglePasswordVisibility"
                                  IconSize="Size.Medium" />

                    <!-- Action links for password reset and first login -->
                    <MudCardActions>
                        <MudStack Spacing="1">
                            <MudText>
                                <MudLink OnClick="NavigateToForgetPassword">Wachtwoord vergeten?</MudLink>
                            </MudText>
                            <MudText>
                                <MudLink OnClick="NavigateToRegister">Heeft u nog geen account ? Registreer</MudLink>
                            </MudText>
                        </MudStack>

                    </MudCardActions>

                    <!-- Login button -->
                    <MudButton ButtonType="ButtonType.Button"
                               OnClick="HandleLoginAsync"
                               Variant="Variant.Filled"
                               Color="Color.Primary"
                               FullWidth="true"
                               Class="ml-auto"
                               Disabled="@_isLoading">
                        @if (_isLoading)
                        {
                            <MudProgressCircular Class="ms-n1" Size="Size.Small" Indeterminate="true" />
                            <MudText Class="ms-2">Inloggen...</MudText>
                        }
                        else
                        {
                            <MudText>Inloggen</MudText>
                        }
                    </MudButton>

                </MudCardContent>
            </MudForm>
        </MudCard>

    }
    

    @if (_isLoggedIn)
    {
        <MudCard Style="position: fixed; top: 20vh; left: 35vw; width: 450px; background-color:#272727; padding:15px; border-radius:15px" Elevation="25">
            <MudCardContent>



                <div style="display: flex; justify-content: center; align-items: center; padding: 20px;">
                    <img src="Picture/Logo_Cineflex.png" style="height: 100px; width: 125px;" alt="Cineflex Logo" />
                </div>

                <div style="display: flex; justify-content: center; align-items: center; padding: 20px;">
                    <MudText Typo="Typo.h5" Style="color:white;"> U bent al ingelogd.</MudText>
                </div>

                                <div style="display: flex; justify-content: center; align-items: center; padding: 20px;">
                <!-- Action links for password reset and first login -->
                <MudCardActions>
                    <MudStack Spacing="1">
                        <MudText>
                            <MudLink OnClick="LogOutAsync">Uitloggen</MudLink>
                        </MudText>
                    </MudStack>
                </MudCardActions>

                </div>

                <!-- Login button -->
                <MudButton ButtonType="ButtonType.Button"
                           OnClick="NavigateToHome"
                           Variant="Variant.Filled"
                           Color="Color.Primary"
                           FullWidth="true"
                           Class="ml-auto"
                           Disabled="@_isLoading">
                    @if (_isLoading)
                    {
                        <MudProgressCircular Class="ms-n1" Size="Size.Small" Indeterminate="true" />
                        <MudText Class="ms-2">sturen naar home...</MudText>
                    }
                    else
                    {
                        <MudText>Terug naar startpagina </MudText>
                    }
                </MudButton>
            </MudCardContent>
        </MudCard>
    }

</div>

<!-- CSS styles for background -->
 <style>
    .start-color {
        background-color: #232323;
    }

    .textCollor{
        color: #F5F5F5 !important;
    }

        .textCollor input::placeholder {
            color: #F5F5F5 !important;
            opacity: 1;
        }

        .textCollor .mud-input-slot ::placeholder {
            color: #F5F5F5 !important;
            opacity: 1;
        }

        .textCollor .mud-input-label {
            color: #F5F5F5 !important;
        }

        .textCollor .mud-input-slot{
            color: #F5F5F5 !important;
        }

    .row {
        display: flex;
        gap: 25px; /* spacing between chairs */
        perspective: 800px;
        position: relative; /* needed for top */
        top: 335px; /* moves row down 60px from its normal position */
    }


    .chair {
        position: relative;
        width: 60px;
        height: 90px;
        transform-style: preserve-3d;
        transition: transform 0.3s;
    }

        .chair:hover {
            transform: translateY(-5px); /* slight lift on hover */
        }

    /* Backrest */
    .backrest {
        width: 100%;
        height: 50px;
        background: linear-gradient(to bottom, #ff4d4d, #b30000);
        border-radius: 10px 10px 0 0;
        position: absolute;
        top: 0;
        box-shadow: inset 0 -5px 5px rgba(0,0,0,0.3);
    }

    /* Seat */
    .seat {
        width: 100%;
        height: 30px;
        background: linear-gradient(to bottom, #b30000, #800000);
        border-radius: 0 0 5px 5px;
        position: absolute;
        bottom: 0;
        box-shadow: inset 0 5px 5px rgba(0,0,0,0.3);
    }

    /* Armrests */
    .arm {
        width: 10px;
        height: 40px;
        background: #800000;
        position: absolute;
        top: 10px;
        border-radius: 5px;
        box-shadow: inset 0 2px 2px rgba(0,0,0,0.5);
    }

        .arm.left {
            left: -10px;
        }

        .arm.right {
            right: -10px;
        }

    /* Legs */
    .leg {
        width: 8px;
        height: 20px;
        background: #333;
        position: absolute;
        bottom: -20px;
        border-radius: 2px;
    }

        .leg.left {
            left: 5px;
        }

        .leg.right {
            right: 5px;
        }

    .row-hidden {
        transition: transform 0.7s ease-in-out;
        transform: translateY(100%);
    }

    .row-visible {
        transition: transform 0.7s ease-in-out;
        transform: translateY(0);
    }
</style>

